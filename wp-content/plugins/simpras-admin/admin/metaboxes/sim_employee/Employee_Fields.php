<?php/** * Created by PhpStorm. * User: Vadim * Date: 2015-04-27 * Time: 08:47 */class Employee_Fields{    public $id;    public $title;    public $context;    public $priority;    public $post_types;    public function __construct()    {        $this->id = 'sim_personal_fields';        $this->title = __('Personal fields', 'sim');        $this->context = 'normal';        $this->priority = 'default';        $this->post_types = array('sim_employee');        add_action('save_post', array($this, 'meta_box_save'), 10, 1);    }    public function meta_box_inner($post)    {        $post_id = $post->ID;        ?>        <table>            <tr>                <th scope="row">                    <label for="_ch_project_url">                        <?php echo __('Employee name', 'sim'); ?>                    </label>                </th>                <td>                    <input type="text" name="_sim_employee_fields[employee_name]" value="<?php echo get_post_meta($post_id, '_sim_employee_name', true) ?>" style="width: 400px;">                </td>            </tr>            <tr>                <th scope="row">                    <label for="_ch_project_url">                        <?php echo __('Employee surname', 'sim'); ?>                    </label>                </th>                <td>                    <input type="text" name="_sim_employee_fields[employee_surname]" value="<?php echo get_post_meta($post_id, '_sim_employee_surname', true) ?>" style="width: 400px;">                </td>            </tr>            <tr>                <th scope="row">                    <label for="_ch_project_url">                        <?php echo __('Employee specialization', 'sim'); ?>                    </label>                </th>                <td>                    <input type="text" name="_sim_employee_fields[employee_specialization]" value="<?php echo get_post_meta($post_id, '_sim_employee_specialization', true) ?>" style="width: 400px;">                </td>            </tr>            <tr>                <th scope="row">                    <label for="_ch_project_url">                        <?php echo __('Employee email', 'sim'); ?>                    </label>                </th>                <td>                    <input type="text" name="_sim_employee_fields[employee_email]" value="<?php echo get_post_meta($post_id, '_sim_employee_email', true) ?>" style="width: 400px;">                </td>            </tr>            <tr>                <th scope="row">                    <label for="_ch_project_url">                        <?php echo __('Employee phone', 'sim'); ?>                    </label>                </th>                <td>                    <input type="text" name="_sim_employee_fields[employee_phone]" value="<?php echo get_post_meta($post_id, '_sim_employee_phone', true) ?>" style="width: 400px;">                </td>            </tr>            <tr>                <th scope="row">                    <label for="_ch_project_url">                        <?php echo __('Employee linkedIn', 'sim'); ?>                    </label>                </th>                <td>                    <input type="text" name="_sim_employee_fields[employee_linkedin]" value="<?php echo get_post_meta($post_id, '_sim_employee_linkedin', true) ?>" style="width: 400px;">                </td>            </tr>        </table>        <?php    }    function meta_box_save($post_id)    {        if (in_array(get_post_type($post_id), $this->post_types)) {            $employee = SIM_Employee::getById($post_id);            if(isset($_POST['_sim_employee_fields']) && !empty($_POST['_sim_employee_fields']))            {                foreach($_POST['_sim_employee_fields'] as $id => $value)                {                    if($value)                    {                        $employee->$id = $value;                    }else{                        $employee->delete_meta_key($id);                    }                    $employee->save();                }            }else{            }        }    }}return new Employee_Fields();